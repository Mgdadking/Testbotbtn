const _0x2909a4=_0x69bd;(function(_0x5c67a9,_0x319849){const _0x3fee4b=_0x69bd,_0x1acd43=_0x5c67a9();while(!![]){try{const _0x3840e2=-parseInt(_0x3fee4b(0xc9))/0x1*(-parseInt(_0x3fee4b(0xed))/0x2)+-parseInt(_0x3fee4b(0xf4))/0x3*(parseInt(_0x3fee4b(0xaf))/0x4)+-parseInt(_0x3fee4b(0xe5))/0x5+-parseInt(_0x3fee4b(0xda))/0x6*(parseInt(_0x3fee4b(0xf9))/0x7)+parseInt(_0x3fee4b(0xb1))/0x8*(parseInt(_0x3fee4b(0xd2))/0x9)+-parseInt(_0x3fee4b(0xb7))/0xa+-parseInt(_0x3fee4b(0xf3))/0xb*(-parseInt(_0x3fee4b(0xb3))/0xc);if(_0x3840e2===_0x319849)break;else _0x1acd43['push'](_0x1acd43['shift']());}catch(_0x53cc2f){_0x1acd43['push'](_0x1acd43['shift']());}}}(_0x1e5b,0x5de10));import _0x96dde9 from'axios';import _0x780ebe from'chalk';import _0x4ccc9e from'fs';import _0x88963 from'path';import{startNokosPoller}from'../../lib/nokos.js';const TAG=_0x780ebe['cyan']('[NOKOS-ORDER]'),dbg=(..._0x90e09d)=>console[_0x2909a4(0xff)](TAG,..._0x90e09d),err=(..._0x44ea39)=>console[_0x2909a4(0xff)](_0x780ebe[_0x2909a4(0xb0)]('[NOKOS-ORDER-ERR]'),..._0x44ea39),ROOT=process[_0x2909a4(0xb5)](),TX_DIR=_0x88963[_0x2909a4(0xc2)](ROOT,_0x2909a4(0xd3),_0x2909a4(0xef)),USER_DB=_0x88963['join'](ROOT,'database','user.json');function ensureDir(_0x5a66e6){const _0x249e1e=_0x2909a4;try{_0x4ccc9e[_0x249e1e(0xd5)](_0x5a66e6,{'recursive':!![]});}catch{}}ensureDir(TX_DIR);function txFile(_0x1f245e){const _0x2665fe=_0x2909a4;return _0x88963[_0x2665fe(0xc2)](TX_DIR,_0x1f245e+_0x2665fe(0xe6));}function readTx(_0x30005e){const _0x379d43=_0x2909a4;try{if(!_0x4ccc9e[_0x379d43(0xdc)](txFile(_0x30005e)))return null;return JSON[_0x379d43(0xc3)](_0x4ccc9e[_0x379d43(0xe8)](txFile(_0x30005e),_0x379d43(0xc5)));}catch{return null;}}function writeTx(_0x2466f9,_0x83172e){const _0x40e8e6=_0x2909a4;_0x4ccc9e[_0x40e8e6(0xdd)](txFile(_0x2466f9),JSON['stringify'](_0x83172e,null,0x2));}function clearTx(_0x108abf){const _0x827888=_0x2909a4;if(_0x4ccc9e['existsSync'](txFile(_0x108abf)))_0x4ccc9e[_0x827888(0xb8)](txFile(_0x108abf));}function _0x1e5b(){const _0x38312a=['3322450cqWWjJ','unlinkSync','toLowerCase','waiting','sender','last_status','âŒ\x20Negara\x20tidak\x20ditemukan.','users','provider_id','â³\x20Menunggu\x20OTP\x20(maks\x208\x20menit)\x0a','CREATE\x20ORDER','join','parse','isArray','utf8','message','cekorder','âŒ\x20Gagal\x20ambil\x20negara.','1jwaLMM','stock','ownerNumber','slice','untungNokos','reply','âŒ\x20Masih\x20ada\x20order\x20aktif.','price=','application/json','9zyjaky','database','get','mkdirSync','Saldo:\x20Rp\x20','nokosorder','ORDER\x20CREATED:','UID:','11574zdwTxs','chat','existsSync','writeFileSync','stringify','Status\x20\x20:\x20','ARG:','SALDO\x20CHECK','data','Order\x20ID:\x20','command','3258050fqVcVV','.json','âŒ\x20Tidak\x20ada\x20order\x20aktif.','readFileSync','success','text','cancelorder','footer','198262xbNSQN','includes','transaction','Nomor\x20\x20\x20:\x20','now','tags','33VCyqNB','3oNKIwn','âŒ\x20Order\x20dibatalkan.\x0aSaldo\x20tidak\x20terpotong.','&operator_id=1','âš™ï¸\x20Aksi\x20Order','https://www.rumahotp.com/api/v2/orders?number_id=','2289mDXxWw','id-ID','âŒ\x20Cancel\x20Order','https://www.rumahotp.com/api/v1/orders/set_status?order_id=','&status=cancel','https://www.rumahotp.com/api/v2/countries?service_id=','log','âŒ\x20Saldo\x20tidak\x20mencukupi.\x0a\x0a','Harga:\x20Rp\x20','countries\x20fail','order_action','split','phone_number','ðŸ”„\x20Cek\x20Order','toLocaleString','order\x20fail','isFinite','single_select','447956sSMEdN','red','3947848pbHzdI','nokos','6074172OAMoUL','order_id','cwd','round'];_0x1e5b=function(){return _0x38312a;};return _0x1e5b();}function _0x69bd(_0x5dd648,_0x26b8c0){_0x5dd648=_0x5dd648-0xa8;const _0x1e5b86=_0x1e5b();let _0x69bdb9=_0x1e5b86[_0x5dd648];return _0x69bdb9;}function loadUsers(){const _0x2771cb=_0x2909a4;if(!_0x4ccc9e[_0x2771cb(0xdc)](USER_DB))_0x4ccc9e[_0x2771cb(0xdd)](USER_DB,JSON[_0x2771cb(0xde)]({'users':{}},null,0x2));return JSON[_0x2771cb(0xc3)](_0x4ccc9e[_0x2771cb(0xe8)](USER_DB,_0x2771cb(0xc5)));}async function apiGet(_0x3231aa){const _0x3ed1e8=_0x2909a4;return _0x96dde9[_0x3ed1e8(0xd4)](_0x3231aa,{'headers':{'x-apikey':global['rumahOtpKey'],'accept':_0x3ed1e8(0xd1)},'timeout':0x4e20});}async function sendOrderPanel(_0x21eda7,_0xc818fc,_0x42e764){const _0x5c0855=_0x2909a4;return _0xc818fc['sendButtonMsg'](_0x21eda7['chat'],{'text':'ðŸ“¦\x20*Status\x20Order*\x0a\x0a'+(_0x5c0855(0xe3)+_0x42e764[_0x5c0855(0xb4)]+'\x0a')+(_0x5c0855(0xf0)+_0x42e764['phone_number']+'\x0a')+(_0x5c0855(0xdf)+(_0x42e764[_0x5c0855(0xbc)]||_0x5c0855(0xba))+'\x0a\x0a')+_0x5c0855(0xc0)+'ðŸ“„Jika\x20Bot\x20Tidak\x20Mengirim\x20OTP\x20Dalam\x203\x20Menit\x20Silahkan\x20Cancel\x20Dan\x20Order\x20Ulang','footer':global[_0x5c0855(0xec)],'buttons':[{'buttonId':_0x5c0855(0x103),'buttonText':{'displayText':_0x5c0855(0xf7)},'nativeFlowInfo':{'name':_0x5c0855(0xae),'paramsJson':JSON[_0x5c0855(0xde)]({'title':'Aksi\x20Order','sections':[{'title':'Pilih','rows':[{'title':_0x5c0855(0xaa),'id':_0x5c0855(0xc7)},{'title':_0x5c0855(0xfb),'id':'cancelorder'}]}]})},'type':0x2}]},{'quoted':_0x21eda7});}let handler=async(_0x3258f0,{fenrys:_0x598d3a})=>{const _0x2ccf4a=_0x2909a4;startNokosPoller(_0x598d3a);const _0x1e885f=_0x3258f0[_0x2ccf4a(0xbb)]['split']('@')[0x0],_0x3d7f9a=(_0x3258f0[_0x2ccf4a(0xea)]||'')['trim'](),_0x5f1e3f=_0x3d7f9a['split'](/\s+/)[0x0][_0x2ccf4a(0xb9)](),_0x1ae06c=_0x3d7f9a[_0x2ccf4a(0xcc)](_0x5f1e3f['length'])['trim']();dbg('CMD:',_0x5f1e3f,_0x2ccf4a(0xe0),_0x1ae06c,_0x2ccf4a(0xd9),_0x1e885f);if(_0x5f1e3f===_0x2ccf4a(0xc7)){const _0x678541=readTx(_0x1e885f);if(!_0x678541)return _0x3258f0[_0x2ccf4a(0xce)](_0x2ccf4a(0xe7));return sendOrderPanel(_0x3258f0,_0x598d3a,_0x678541);}if(_0x5f1e3f===_0x2ccf4a(0xeb)){const _0x2b845b=readTx(_0x1e885f);if(!_0x2b845b)return _0x3258f0[_0x2ccf4a(0xce)]('âŒ\x20Tidak\x20ada\x20order\x20aktif.');try{await apiGet(_0x2ccf4a(0xfc)+_0x2b845b[_0x2ccf4a(0xb4)]+_0x2ccf4a(0xfd));}catch{}return clearTx(_0x1e885f),_0x3258f0[_0x2ccf4a(0xce)](_0x2ccf4a(0xf5));}if(_0x5f1e3f===_0x2ccf4a(0xd7)){if(!_0x1ae06c)return _0x3258f0['reply']('âŒ\x20Format:\x20nokosorder\x20app|country|idx');if(readTx(_0x1e885f))return _0x3258f0['reply'](_0x2ccf4a(0xcf));const [_0x5c6f8e,_0x5499cc,_0x43ced3]=_0x1ae06c[_0x2ccf4a(0xa8)]('|'),_0x5ed7e8=Number(_0x43ced3);if(!_0x5c6f8e||!_0x5499cc||!Number[_0x2ccf4a(0xad)](_0x5ed7e8))return _0x3258f0[_0x2ccf4a(0xce)]('âŒ\x20Format\x20salah.');dbg(_0x2ccf4a(0xc1),_0x5c6f8e,_0x5499cc,_0x5ed7e8);let _0x5d39fd;try{const _0x484e7a=await apiGet(_0x2ccf4a(0xfe)+_0x5c6f8e);_0x5d39fd=_0x484e7a?.[_0x2ccf4a(0xe2)]?.['data']||[];}catch(_0x59a7fc){return err(_0x2ccf4a(0x102),_0x59a7fc[_0x2ccf4a(0xc6)]),_0x3258f0[_0x2ccf4a(0xce)](_0x2ccf4a(0xc8));}const _0x4c10ac=_0x5d39fd['find'](_0x473ab1=>String(_0x473ab1['number_id'])===String(_0x5499cc));if(!_0x4c10ac)return _0x3258f0[_0x2ccf4a(0xce)](_0x2ccf4a(0xbd));const _0xe09030=_0x4c10ac['pricelist']?.[_0x5ed7e8];if(!_0xe09030||_0xe09030[_0x2ccf4a(0xca)]<=0x0)return _0x3258f0[_0x2ccf4a(0xce)]('âŒ\x20Stock\x20habis.');const _0xae78e6=loadUsers(),_0x10b97c=_0xae78e6[_0x2ccf4a(0xbe)][_0x1e885f],_0x3cad85=Array[_0x2ccf4a(0xc4)](global[_0x2ccf4a(0xcb)])?global[_0x2ccf4a(0xcb)][_0x2ccf4a(0xee)](_0x1e885f):global[_0x2ccf4a(0xcb)]===_0x1e885f,_0x5b0543=Number(_0xe09030['price']||0x0),_0x13784b=Number(global[_0x2ccf4a(0xcd)]||0x0),_0x30c956=_0x3cad85?_0x5b0543:Math[_0x2ccf4a(0xb6)](_0x5b0543+_0x5b0543*_0x13784b/0x64),_0x57ff20=Number(_0x10b97c?.['saldoNokos']||0x0);dbg(_0x2ccf4a(0xe1),'saldo=',_0x57ff20,_0x2ccf4a(0xd0),_0x30c956);if(_0x57ff20<_0x30c956)return _0x3258f0[_0x2ccf4a(0xce)](_0x2ccf4a(0x100)+(_0x2ccf4a(0x101)+_0x30c956[_0x2ccf4a(0xab)](_0x2ccf4a(0xfa))+'\x0a')+(_0x2ccf4a(0xd6)+_0x57ff20[_0x2ccf4a(0xab)]('id-ID')));let _0x5c78d2;try{const _0x3bb51a=await apiGet(_0x2ccf4a(0xf8)+_0x5499cc+'&provider_id='+_0xe09030[_0x2ccf4a(0xbf)]+_0x2ccf4a(0xf6));if(!_0x3bb51a?.['data']?.[_0x2ccf4a(0xe9)]||!_0x3bb51a?.['data']?.[_0x2ccf4a(0xe2)])return _0x3258f0[_0x2ccf4a(0xce)]('âŒ\x20Gagal\x20membuat\x20order\x20(provider\x20tidak\x20tersedia).');_0x5c78d2=_0x3bb51a[_0x2ccf4a(0xe2)][_0x2ccf4a(0xe2)];}catch(_0x497c50){return err(_0x2ccf4a(0xac),_0x497c50['message']),_0x3258f0[_0x2ccf4a(0xce)]('âŒ\x20Gagal\x20buat\x20order\x20(API\x20error).');}const _0xcf80e6={'uid':_0x1e885f,'sender':_0x3258f0['sender'],'chat':_0x3258f0[_0x2ccf4a(0xdb)],'order_id':_0x5c78d2[_0x2ccf4a(0xb4)],'phone_number':_0x5c78d2[_0x2ccf4a(0xa9)],'price':_0x30c956,'created_at':Date[_0x2ccf4a(0xf1)](),'status':'pending'};return writeTx(_0x1e885f,_0xcf80e6),dbg(_0x2ccf4a(0xd8),_0x5c78d2[_0x2ccf4a(0xb4)]),sendOrderPanel(_0x3258f0,_0x598d3a,_0xcf80e6);}};handler[_0x2909a4(0xe4)]=/^(nokosorder|cekorder|cancelorder)$/i,handler[_0x2909a4(0xf2)]=[_0x2909a4(0xb2)];export default handler;