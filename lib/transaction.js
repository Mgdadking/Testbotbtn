const _0x535618=_0x368b;(function(_0x44e511,_0x372c9f){const _0x460d37=_0x368b,_0x5d6ce8=_0x44e511();while(!![]){try{const _0x4512b5=-parseInt(_0x460d37(0xd0))/0x1*(parseInt(_0x460d37(0xb1))/0x2)+-parseInt(_0x460d37(0xc8))/0x3+parseInt(_0x460d37(0xa3))/0x4*(-parseInt(_0x460d37(0x9b))/0x5)+parseInt(_0x460d37(0x8f))/0x6*(parseInt(_0x460d37(0x9d))/0x7)+parseInt(_0x460d37(0xb4))/0x8+-parseInt(_0x460d37(0x9e))/0x9*(parseInt(_0x460d37(0x84))/0xa)+parseInt(_0x460d37(0x81))/0xb;if(_0x4512b5===_0x372c9f)break;else _0x5d6ce8['push'](_0x5d6ce8['shift']());}catch(_0x16a246){_0x5d6ce8['push'](_0x5d6ce8['shift']());}}}(_0x598d,0xb7df0));import _0x57e7df from'fs';import _0x5bb943 from'path';const STOCK_DIR=_0x5bb943[_0x535618(0xa5)](process['cwd'](),_0x535618(0x8a),'stock'),TX_DIR=_0x5bb943[_0x535618(0xa5)](process[_0x535618(0xa8)](),_0x535618(0x8a),_0x535618(0xe1)),CART_DIR=_0x5bb943[_0x535618(0xa5)](process[_0x535618(0xa8)](),_0x535618(0x8a),'keranjang'),ACCOUNT_DB=_0x5bb943[_0x535618(0xa5)](process['cwd'](),_0x535618(0x8a),_0x535618(0xc2)),API_BASE=_0x535618(0x76),LICENSE=global['cashifyLicenseKey']||process[_0x535618(0xa6)]['CASHIFY_LICENSE']||'',BOT_NAME=global[_0x535618(0x8c)]||_0x535618(0xe5),OWNER_JID=(Array[_0x535618(0xdb)](global[_0x535618(0xc9)])?global[_0x535618(0xc9)][0x0]:global[_0x535618(0xc9)])||'',norm=(_0x46ba88='')=>String(_0x46ba88)[_0x535618(0xa0)]()[_0x535618(0x7e)]();function ensureDir(_0x4ecb2a){try{_0x57e7df['mkdirSync'](_0x4ecb2a,{'recursive':!![]});}catch{}}function toJid(_0x3e04a6){const _0x1a8ff7=_0x535618,_0x2d25d2=String(_0x3e04a6||'')['trim']();if(!_0x2d25d2)return'';return _0x2d25d2[_0x1a8ff7(0xe0)]('@')?_0x2d25d2:_0x2d25d2+_0x1a8ff7(0x73);}function rup(_0x6875d2){const _0x41b09b=_0x535618;try{return'Rp'+Number(_0x6875d2||0x0)[_0x41b09b(0xe9)]('id-ID');}catch{return'Rp'+_0x6875d2;}}function stockFile(_0x4909a0){const _0x57e725=_0x535618;return ensureDir(STOCK_DIR),_0x5bb943[_0x57e725(0xa5)](STOCK_DIR,norm(_0x4909a0)+_0x57e725(0xbf));}function readStock(_0x2906f0){const _0x20a4ed=_0x535618,_0x83a12f=stockFile(_0x2906f0);if(!_0x57e7df[_0x20a4ed(0xaa)](_0x83a12f))return{'harga':null,'items':[]};try{const _0x223e85=JSON[_0x20a4ed(0xc6)](_0x57e7df[_0x20a4ed(0xa4)](_0x83a12f,_0x20a4ed(0x9a))||'[]');if(Array[_0x20a4ed(0xdb)](_0x223e85))return{'harga':null,'items':_0x223e85};return{'harga':typeof _0x223e85[_0x20a4ed(0x85)]===_0x20a4ed(0xb8)?_0x223e85[_0x20a4ed(0x85)]:null,'items':Array[_0x20a4ed(0xdb)](_0x223e85[_0x20a4ed(0x72)])?_0x223e85[_0x20a4ed(0x72)]:[]};}catch{return{'harga':null,'items':[]};}}function writeStock(_0x499431,_0x14f938){const _0x189b66=_0x535618,_0x3f6b35=stockFile(_0x499431),_0x44772b={'harga':typeof _0x14f938['harga']===_0x189b66(0xb8)?_0x14f938[_0x189b66(0x85)]:null,'items':Array[_0x189b66(0xdb)](_0x14f938[_0x189b66(0x72)])?_0x14f938[_0x189b66(0x72)]:[]};_0x57e7df[_0x189b66(0x8e)](_0x3f6b35,JSON[_0x189b66(0x98)](_0x44772b,null,0x2));}function removeTxFile(_0x164118){const _0x4f046b=_0x535618;try{const _0x1f8fda=_0x5bb943['join'](TX_DIR,_0x164118+_0x4f046b(0xbf));if(_0x57e7df[_0x4f046b(0xaa)](_0x1f8fda))_0x57e7df[_0x4f046b(0xb7)](_0x1f8fda);}catch(_0x3a488d){console[_0x4f046b(0xa9)]('[removeTxFile]',_0x3a488d);}}function userTxFile(_0x5eec23){return ensureDir(TX_DIR),_0x5bb943['join'](TX_DIR,_0x5eec23+'.json');}function readUserTx(_0x4071d6){const _0x443fe3=_0x535618,_0x4a2ffa=userTxFile(_0x4071d6);if(!_0x57e7df[_0x443fe3(0xaa)](_0x4a2ffa))return[];try{return JSON['parse'](_0x57e7df[_0x443fe3(0xa4)](_0x4a2ffa,'utf8')||'[]')||[];}catch{return[];}}function writeUserTx(_0x3af6d4,_0x33354c){const _0x111d39=_0x535618;_0x57e7df[_0x111d39(0x8e)](userTxFile(_0x3af6d4),JSON[_0x111d39(0x98)](_0x33354c,null,0x2));}function readAccountDB(){const _0x359397=_0x535618;if(!_0x57e7df['existsSync'](ACCOUNT_DB))return{'users':{},'mutasi':{}};try{const _0x4b23f0=JSON[_0x359397(0xc6)](_0x57e7df[_0x359397(0xa4)](ACCOUNT_DB,'utf8')||'{}');return{'users':_0x4b23f0&&typeof _0x4b23f0[_0x359397(0x6e)]===_0x359397(0xdd)&&_0x4b23f0[_0x359397(0x6e)]?_0x4b23f0[_0x359397(0x6e)]:{},'mutasi':_0x4b23f0&&typeof _0x4b23f0[_0x359397(0xce)]===_0x359397(0xdd)&&_0x4b23f0[_0x359397(0xce)]?_0x4b23f0['mutasi']:{}};}catch{return{'users':{},'mutasi':{}};}}function writeAccountDB(_0x308c9d){const _0x19cd07=_0x535618;ensureDir(_0x5bb943[_0x19cd07(0x83)](ACCOUNT_DB)),_0x57e7df[_0x19cd07(0x8e)](ACCOUNT_DB,JSON['stringify'](_0x308c9d,null,0x2));}function getDayKey(_0x3ab11e=new Date()){const _0x2b9a86=_0x535618,_0x4c1940=_0x3ab11e[_0x2b9a86(0x88)](),_0x342899=String(_0x3ab11e[_0x2b9a86(0xcb)]()+0x1)[_0x2b9a86(0xe2)](0x2,'0'),_0x1546b9=String(_0x3ab11e['getDate']())[_0x2b9a86(0xe2)](0x2,'0');return _0x4c1940+'-'+_0x342899+'-'+_0x1546b9;}function inc(_0x2a2331,_0xa4b927,_0x16b4a1=0x1){return _0x2a2331[_0xa4b927]=(Number(_0x2a2331[_0xa4b927])||0x0)+Number(_0x16b4a1||0x0),_0x2a2331[_0xa4b927];}function updateAccountOnPaid({buyerJid:_0x8dd395,deliveredItems:_0x534b9d,totalProduk:_0x14b0ac,totalBayar:_0x431022}){const _0x2cd2a7=_0x535618,_0x159591=Math['max'](0x0,Number(_0x431022||0x0)-Number(_0x14b0ac||0x0)),_0x206386=getDayKey(new Date()),_0x59b2a8=readAccountDB(),_0x291b7d=toJid(_0x8dd395);!_0x59b2a8[_0x2cd2a7(0x6e)][_0x291b7d]&&(_0x59b2a8[_0x2cd2a7(0x6e)][_0x291b7d]={'total_pengeluaran':0x0,'total_produk_dibeli':0x0,'produk':{}});inc(_0x59b2a8['users'][_0x291b7d],'total_pengeluaran',Number(_0x14b0ac||0x0)),inc(_0x59b2a8[_0x2cd2a7(0x6e)][_0x291b7d],'total_produk_dibeli',_0x534b9d[_0x2cd2a7(0x6d)]);for(const _0x1c0d05 of _0x534b9d){const _0x298dce=norm(_0x1c0d05[_0x2cd2a7(0xe6)]);if(!_0x59b2a8[_0x2cd2a7(0x6e)][_0x291b7d][_0x2cd2a7(0xaf)][_0x298dce])_0x59b2a8[_0x2cd2a7(0x6e)][_0x291b7d][_0x2cd2a7(0xaf)][_0x298dce]=0x0;_0x59b2a8[_0x2cd2a7(0x6e)][_0x291b7d]['produk'][_0x298dce]+=0x1;}!_0x59b2a8[_0x2cd2a7(0xce)][_0x206386]&&(_0x59b2a8[_0x2cd2a7(0xce)][_0x206386]={'total_produk_terjual':0x0,'total_pendapatan':0x0,'total_fee':0x0,'produk':{}});inc(_0x59b2a8['mutasi'][_0x206386],_0x2cd2a7(0xd4),_0x534b9d[_0x2cd2a7(0x6d)]),inc(_0x59b2a8[_0x2cd2a7(0xce)][_0x206386],'total_pendapatan',Number(_0x14b0ac||0x0)),inc(_0x59b2a8[_0x2cd2a7(0xce)][_0x206386],'total_fee',_0x159591);for(const _0xdbc00a of _0x534b9d){const _0x4325bf=norm(_0xdbc00a['product']);if(!_0x59b2a8[_0x2cd2a7(0xce)][_0x206386][_0x2cd2a7(0xaf)][_0x4325bf])_0x59b2a8[_0x2cd2a7(0xce)][_0x206386][_0x2cd2a7(0xaf)][_0x4325bf]=0x0;_0x59b2a8[_0x2cd2a7(0xce)][_0x206386]['produk'][_0x4325bf]+=0x1;}writeAccountDB(_0x59b2a8);}function cartFile(_0x4afb60){const _0x53f22c=_0x535618;return ensureDir(CART_DIR),_0x5bb943[_0x53f22c(0xa5)](CART_DIR,_0x4afb60+_0x53f22c(0xbf));}function readCart(_0x403ea7){const _0xb3d6ba=_0x535618,_0x56784d=cartFile(_0x403ea7);if(!_0x57e7df[_0xb3d6ba(0xaa)](_0x56784d))return{'items':[]};try{return JSON['parse'](_0x57e7df[_0xb3d6ba(0xa4)](_0x56784d,_0xb3d6ba(0x9a))||_0xb3d6ba(0xac))||{'items':[]};}catch{return{'items':[]};}}function writeCart(_0xd29f6f,_0x1d7774){const _0x7a3304=_0x535618;_0x57e7df[_0x7a3304(0x8e)](cartFile(_0xd29f6f),JSON['stringify'](_0x1d7774,null,0x2));}function applyDeliveredToCart(_0x10967,_0x221afa){const _0xf15349=_0x535618,_0x2d8564=readCart(_0x10967);if(!_0x2d8564||!Array[_0xf15349(0xdb)](_0x2d8564[_0xf15349(0x72)])||!_0x2d8564['items'][_0xf15349(0x6d)])return;const _0x4108c9={};for(const _0x14ea44 of _0x221afa){const _0x118650=norm(_0x14ea44[_0xf15349(0xe6)]);_0x4108c9[_0x118650]=(_0x4108c9[_0x118650]||0x0)+0x1;}_0x2d8564['items']=_0x2d8564[_0xf15349(0x72)]['map'](_0x2e5bcd=>{const _0x8b8d8d=_0xf15349,_0x94c359=norm(_0x2e5bcd[_0x8b8d8d(0xe6)]),_0x200e22=_0x4108c9[_0x94c359]||0x0;if(_0x200e22<=0x0)return _0x2e5bcd;const _0x4a4f9d=Math['max'](0x0,Number(_0x2e5bcd[_0x8b8d8d(0xdf)]||0x0)-_0x200e22);return _0x4108c9[_0x94c359]=Math[_0x8b8d8d(0x70)](0x0,_0x200e22-Number(_0x2e5bcd[_0x8b8d8d(0xdf)]||0x0)),{..._0x2e5bcd,'qty':_0x4a4f9d};})[_0xf15349(0x7c)](_0x4c07b3=>Number(_0x4c07b3[_0xf15349(0xdf)]||0x0)>0x0),_0x2d8564['updated_at']=Date[_0xf15349(0x78)](),writeCart(_0x10967,_0x2d8564);}async function postJSON(_0x9e44dc,_0x5f17dc){const _0x3cffdf=_0x535618,_0x1e0902=await fetch(_0x9e44dc,{'method':_0x3cffdf(0xd6),'headers':{'content-type':_0x3cffdf(0x94),'x-license-key':LICENSE},'body':JSON[_0x3cffdf(0x98)](_0x5f17dc)}),_0x443435=await _0x1e0902[_0x3cffdf(0xcf)]()['catch'](()=>({}));if(!_0x1e0902['ok'])throw new Error(_0x3cffdf(0x7a)+_0x1e0902[_0x3cffdf(0xd2)]+'\x20'+JSON[_0x3cffdf(0x98)](_0x443435));return _0x443435;}function _0x368b(_0x31bec3,_0x24eace){_0x31bec3=_0x31bec3-0x6c;const _0x598d5f=_0x598d();let _0x368bbd=_0x598d5f[_0x31bec3];return _0x368bbd;}async function handleTx(_0x3c8528,_0x1994a2,_0x2ba82f){const _0x2afc8e=_0x535618;if(_0x2ba82f[_0x2afc8e(0xd2)]!=='pending'&&_0x2ba82f[_0x2afc8e(0x79)])return;let _0x3eacf0=null;try{const _0x213ea8=await postJSON(API_BASE+_0x2afc8e(0x77),{'transactionId':_0x2ba82f[_0x2afc8e(0x9c)]});_0x3eacf0=String(_0x213ea8?.[_0x2afc8e(0x6c)]?.['status']||'')[_0x2afc8e(0x7e)]();}catch{}if(_0x2ba82f[_0x2afc8e(0xd2)]===_0x2afc8e(0xae)||_0x3eacf0===_0x2afc8e(0xae)){await deleteQROnce(_0x3c8528,_0x2ba82f),await notifyCancelOnce(_0x3c8528,_0x1994a2,_0x2ba82f);return;}if(_0x3eacf0===_0x2afc8e(0x9f)){const _0x71708f=readUserTx(_0x1994a2),_0x2eacea=_0x71708f[_0x2afc8e(0xba)](_0x422e16=>_0x422e16[_0x2afc8e(0x9c)]===_0x2ba82f[_0x2afc8e(0x9c)]);_0x2eacea!==-0x1&&(_0x71708f[_0x2eacea][_0x2afc8e(0xd2)]=_0x2afc8e(0x9f),_0x71708f[_0x2eacea]['expired_at']=new Date()[_0x2afc8e(0xb2)](),writeUserTx(_0x1994a2,_0x71708f),await deleteQROnce(_0x3c8528,_0x71708f[_0x2eacea]),await notifyExpiredOnce(_0x3c8528,_0x1994a2,_0x71708f[_0x2eacea]));return;}_0x3eacf0===_0x2afc8e(0xa2)&&await deliverIfPaidForUser(_0x3c8528,_0x1994a2,_0x2ba82f);}async function deleteQROnce(_0x396b33,_0x12bb9d){const _0x519369=_0x535618;try{!_0x12bb9d[_0x519369(0x79)]&&_0x12bb9d['qrKey']&&(await _0x396b33[_0x519369(0x6f)](_0x12bb9d[_0x519369(0x75)][_0x519369(0xbd)],{'delete':_0x12bb9d[_0x519369(0x75)]}),_0x12bb9d[_0x519369(0x79)]=!![]);}catch{}}function _0x598d(){const _0x379024=['replace','writeFileSync','665670ghWweI','\x0aâ”‚\x20\x20di\x20*','â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®','â”‚\x20âš™ï¸\x20Fee\x20Admin\x20\x20\x20\x20:\x20','â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯','application/json','â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚','[cleanup\x20transaction]','reduce','stringify','â”‚\x20ðŸ‘¤\x20Pembeli\x20:\x20','utf8','55mAJUIB','transactionId','42gbKUZp','9NnfKXr','expired','trim','\x0aâš ï¸\x20Item\x20belum\x20terpenuhi:\x20','paid','275524XvJcuN','readFileSync','join','env','â”‚\x20ðŸ”\x20*Data\x20Akun:*','cwd','error','existsSync','\x20|\x20','{\x22items\x22:[]}','[send\x20buyer\x20account]','cancel','produk','\x20=\x20','2060698PvNNiO','toISOString','map','7924600cEWqdS','subtotal','â”‚\x20â³\x20*Transaksi\x20Expired*','unlinkSync','number','totalAmount','findIndex','[owner\x20report]','push','remoteJid','pending','.json','âœ…\x20*Terima\x20kasih\x20telah\x20membeli*\x0aâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\x0aâ”‚\x20\x20','â”‚\x20ðŸ”\x20*Akun\x20Pembelian\x20Kamu*','account.json','â”‚\x20(tidak\x20ada\x20akun\x20dikirim)','Pembeli:\x20','delivered','parse','password','3968619xIHvdD','ownerNumber','\x20(tersisa\x20','getMonth','\x20@\x20','â”‚\x20ID:\x20','mutasi','json','1slBFIM','email','status','shift','total_produk_terjual','â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯','POST','â”‚\x20â€¢\x20','unitPrice','*\x20ðŸ’«\x0aâ”‚\x20\x20Detail\x20akun\x20dikirim\x20via\x20private.\x0aâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯','â”‚\x20QR\x20telah\x20dihapus.','isArray','â”‚\x20ðŸ’°\x20Harga\x20Produk\x20:\x20','object','processing','qty','includes','transaction','padStart','â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯','expectedTotal','Store\x20Bot','product','â”‚â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‚','readdirSync','toLocaleString','data','length','users','sendMessage','max','last_check_at','items','@s.whatsapp.net','â”‚\x20âŒ\x20*Transaksi\x20Dibatalkan*','qrKey','https://cashify.my.id/api/generate','/check-status','now','qr_deleted','HTTP\x20','\x0aâ”‚\x20\x20\x20\x20\x20âœ‰ï¸\x20','filter','â”‚\x20\x20','toLowerCase','chat','expectedTotalWithFee','40261133cLuvln','â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®','dirname','14522990NMDfbN','harga','endsWith','cancel_notified','getFullYear','â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚','database','\x0aâ”‚\x20\x20\x20\x20','botName'];_0x598d=function(){return _0x379024;};return _0x598d();}async function notifyCancelOnce(_0x526f86,_0x38e048,_0x2be9d4){const _0x4b0812=_0x535618,_0x3d23ae=readUserTx(_0x38e048),_0x438175=_0x3d23ae[_0x4b0812(0xba)](_0x1b43f3=>_0x1b43f3[_0x4b0812(0x9c)]===_0x2be9d4['transactionId']);if(_0x438175===-0x1)return;if(_0x3d23ae[_0x438175][_0x4b0812(0x87)])return;try{const _0x1dd017=_0x3d23ae[_0x438175][_0x4b0812(0x7f)]||toJid(_0x38e048);await _0x526f86[_0x4b0812(0x6f)](_0x1dd017,{'text':['â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®',_0x4b0812(0x74),'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤',_0x4b0812(0xcd)+_0x2be9d4[_0x4b0812(0x9c)],_0x4b0812(0xda),_0x4b0812(0x93)][_0x4b0812(0xa5)]('\x0a')});}catch{}_0x3d23ae[_0x438175][_0x4b0812(0x79)]=!![],_0x3d23ae[_0x438175]['cancel_notified']=!![],writeUserTx(_0x38e048,_0x3d23ae),removeTxFile(_0x38e048);}async function notifyExpiredOnce(_0x49bfb2,_0x33cc7e,_0x328470){const _0x2ae4f5=_0x535618,_0x31b54e=readUserTx(_0x33cc7e),_0x56bb76=_0x31b54e['findIndex'](_0x3bc539=>_0x3bc539[_0x2ae4f5(0x9c)]===_0x328470['transactionId']);if(_0x56bb76===-0x1)return;if(_0x31b54e[_0x56bb76]['expired_notified'])return;try{const _0x248b6c=_0x31b54e[_0x56bb76][_0x2ae4f5(0x7f)]||toJid(_0x33cc7e);await _0x49bfb2['sendMessage'](_0x248b6c,{'text':[_0x2ae4f5(0x91),_0x2ae4f5(0xb6),'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤',_0x2ae4f5(0xcd)+_0x328470[_0x2ae4f5(0x9c)],_0x2ae4f5(0xda),_0x2ae4f5(0x93)]['join']('\x0a')});}catch{}_0x31b54e[_0x56bb76]['qr_deleted']=!![],_0x31b54e[_0x56bb76]['expired_notified']=!![],writeUserTx(_0x33cc7e,_0x31b54e),removeTxFile(_0x33cc7e);}async function deliverIfPaidForUser(_0x49ac73,_0x31a848,_0x4f463b){const _0x3907d4=_0x535618;let _0x411bca;try{_0x411bca=await postJSON(API_BASE+_0x3907d4(0x77),{'transactionId':_0x4f463b['transactionId']});}catch{return;}const _0x2c7907=String(_0x411bca?.['data']?.[_0x3907d4(0xd2)]||'')[_0x3907d4(0x7e)]();if(_0x2c7907!==_0x3907d4(0xa2))return;const _0x4d3947=readUserTx(_0x31a848),_0x4d2a3e=_0x4d3947[_0x3907d4(0xba)](_0xbdd9ae=>_0xbdd9ae[_0x3907d4(0x9c)]===_0x4f463b['transactionId']);if(_0x4d2a3e===-0x1)return;if(_0x4d3947[_0x4d2a3e][_0x3907d4(0xd2)]==='paid')return;if(_0x4d3947[_0x4d2a3e][_0x3907d4(0xde)])return;_0x4d3947[_0x4d2a3e][_0x3907d4(0xde)]=!![],writeUserTx(_0x31a848,_0x4d3947);const _0x510450=toJid(_0x31a848),_0x22da11=_0x4d3947[_0x4d2a3e]['chat']&&String(_0x4d3947[_0x4d2a3e][_0x3907d4(0x7f)])[_0x3907d4(0xe0)]('@')?_0x4d3947[_0x4d2a3e][_0x3907d4(0x7f)]:_0x510450,_0x3d5f79=_0x4d3947[_0x4d2a3e][_0x3907d4(0x72)]||[],_0xc2b98b=[],_0x307ead=[];for(const _0x5b986e of _0x3d5f79){const _0x286db1=readStock(_0x5b986e['product']);if((_0x286db1['items']?.['length']||0x0)<_0x5b986e[_0x3907d4(0xdf)]){_0x307ead[_0x3907d4(0xbc)](_0x5b986e[_0x3907d4(0xe6)]+_0x3907d4(0xca)+_0x286db1['items'][_0x3907d4(0x6d)]+',\x20butuh\x20'+_0x5b986e['qty']+')');continue;}for(let _0x371ccc=0x0;_0x371ccc<_0x5b986e[_0x3907d4(0xdf)];_0x371ccc++){const _0x35df84=_0x286db1[_0x3907d4(0x72)][_0x3907d4(0xd3)]();_0xc2b98b['push']({'product':_0x5b986e['product'],'email':_0x35df84?.[_0x3907d4(0xd1)],'password':_0x35df84?.[_0x3907d4(0xc7)],'price':_0x5b986e[_0x3907d4(0xd8)]});}writeStock(_0x5b986e[_0x3907d4(0xe6)],_0x286db1);}const _0x4611bf=_0x3d5f79[_0x3907d4(0x97)]((_0x3d83f0,_0x19ec2d)=>_0x3d83f0+Number(_0x19ec2d['unitPrice']||0x0)*Number(_0x19ec2d[_0x3907d4(0xdf)]||0x0),0x0),_0x3b803c=_0x4d3947[_0x4d2a3e][_0x3907d4(0xb9)]||_0x4d3947[_0x4d2a3e][_0x3907d4(0x80)]||_0x4d3947[_0x4d2a3e][_0x3907d4(0xe4)]||_0x4611bf;_0x4d3947[_0x4d2a3e][_0x3907d4(0xd2)]='paid',_0x4d3947[_0x4d2a3e][_0x3907d4(0xc5)]=_0xc2b98b,_0x4d3947[_0x4d2a3e]['delivered_at']=new Date()[_0x3907d4(0xb2)](),_0x4d3947[_0x4d2a3e][_0x3907d4(0x79)]=!![],writeUserTx(_0x31a848,_0x4d3947);try{if(_0x4f463b['qrKey'])await _0x49ac73[_0x3907d4(0x6f)](_0x4f463b[_0x3907d4(0x75)][_0x3907d4(0xbd)],{'delete':_0x4f463b[_0x3907d4(0x75)]});}catch{}try{updateAccountOnPaid({'buyerJid':_0x510450,'deliveredItems':_0xc2b98b,'totalProduk':_0x4611bf,'totalBayar':_0x3b803c});}catch(_0x372df1){console[_0x3907d4(0xa9)]('[account.json]',_0x372df1);}try{applyDeliveredToCart(_0x31a848,_0xc2b98b);}catch(_0x2f078d){console[_0x3907d4(0xa9)]('[keranjang]',_0x2f078d);}try{const _0x24d78f=_0x3d5f79['map'](_0x2e7da2=>_0x2e7da2[_0x3907d4(0xe6)]+'Ã—'+_0x2e7da2[_0x3907d4(0xdf)])[_0x3907d4(0xa5)](',\x20'),_0x6dedc2=_0x3907d4(0xc0)+_0x24d78f+_0x3907d4(0x90)+BOT_NAME+_0x3907d4(0xd9);await _0x49ac73['sendMessage'](_0x22da11,{'text':_0x6dedc2});}catch{}try{if(_0xc2b98b[_0x3907d4(0x6d)]){const _0x104f23=_0xc2b98b[_0x3907d4(0xb3)]((_0x405cab,_0x5d81fc)=>_0x3907d4(0x7d)+(_0x5d81fc+0x1)+'.\x20'+_0x405cab['product']+_0x3907d4(0x7b)+_0x405cab[_0x3907d4(0xd1)]+'\x0aâ”‚\x20\x20\x20\x20\x20ðŸ”‘\x20'+_0x405cab[_0x3907d4(0xc7)]);let _0x156c59=['â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®',_0x3907d4(0xc1),_0x3907d4(0x95),..._0x104f23,_0x3907d4(0xd5)]['join']('\x0a');if(_0x307ead['length'])_0x156c59+=_0x3907d4(0xa1)+_0x307ead['join'](',\x20');await _0x49ac73[_0x3907d4(0x6f)](_0x510450,{'text':_0x156c59});}}catch(_0x23828f){console[_0x3907d4(0xa9)](_0x3907d4(0xad),_0x23828f);}try{if(OWNER_JID){const _0x149843=_0xc2b98b[_0x3907d4(0xb3)]((_0x196dcb,_0x4d7975)=>'â”‚\x20'+(_0x4d7975+0x1)+'.\x20'+_0x196dcb[_0x3907d4(0xe6)]+_0x3907d4(0x8b)+_0x196dcb[_0x3907d4(0xd1)]+_0x3907d4(0xab)+_0x196dcb[_0x3907d4(0xc7)])[_0x3907d4(0xa5)]('\x0a')||_0x3907d4(0xc3),_0x1db14c=_0x3d5f79['map'](_0x43c3d7=>{const _0x4d47b8=_0x3907d4,_0x812e25=_0x43c3d7[_0x4d47b8(0xb5)]??_0x43c3d7[_0x4d47b8(0xd8)]*_0x43c3d7[_0x4d47b8(0xdf)];return _0x4d47b8(0xd7)+_0x43c3d7[_0x4d47b8(0xe6)]+'\x20Ã—\x20'+_0x43c3d7['qty']+_0x4d47b8(0xcc)+rup(_0x43c3d7[_0x4d47b8(0xd8)])+_0x4d47b8(0xb0)+rup(_0x812e25);})[_0x3907d4(0xa5)]('\x0a'),_0x15b89e=_0x3d5f79[_0x3907d4(0x97)]((_0x520863,_0xce1325)=>_0x520863+_0xce1325[_0x3907d4(0xd8)]*_0xce1325[_0x3907d4(0xdf)],0x0),_0x4e046e=_0x4d3947[_0x4d2a3e][_0x3907d4(0xb9)]||_0x4d3947[_0x4d2a3e][_0x3907d4(0x80)]||_0x4d3947[_0x4d2a3e]['expectedTotal']||_0x15b89e,_0x3f0b17=Math['max'](0x0,Number(_0x4e046e||0x0)-Number(_0x15b89e||0x0)),_0x559d6e=[_0x3907d4(0x82),'â”‚\x20ðŸ’¸\x20*Transaksi\x20Lunas*',_0x3907d4(0xe7),_0x3907d4(0x99)+_0x31a848,'â”‚\x20ðŸ†”\x20Trx\x20ID\x20\x20:\x20'+_0x4f463b[_0x3907d4(0x9c)],'â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚',_0x1db14c,_0x3907d4(0x89),_0x3907d4(0xdc)+rup(_0x15b89e),_0x3907d4(0x92)+rup(_0x3f0b17),_0x3907d4(0x89),_0x3907d4(0xa7),_0x149843,_0x3907d4(0xe3)][_0x3907d4(0xa5)]('\x0a');await _0x49ac73[_0x3907d4(0x6f)](toJid(OWNER_JID),{'text':_0x559d6e,'quoted':{'key':{'remoteJid':_0x510450},'message':{'conversation':_0x3907d4(0xc4)+_0x31a848}}});}}catch(_0x3be5f9){console['error'](_0x3907d4(0xbb),_0x3be5f9);}try{const _0x3f8895=_0x5bb943[_0x3907d4(0xa5)](TX_DIR,_0x31a848+_0x3907d4(0xbf));_0x57e7df[_0x3907d4(0xaa)](_0x3f8895)&&_0x57e7df[_0x3907d4(0xb7)](_0x3f8895);}catch(_0x136c1e){console[_0x3907d4(0xa9)](_0x3907d4(0x96),_0x136c1e);}}let _polling=![],_fenrys=null;export function startTransactionPoller(_0x4c9569,_0x16cdcb=0x1388){_fenrys=_0x4c9569||_fenrys;if(_polling)return;_polling=!![],setInterval(async()=>{const _0x10f0ca=_0x368b;if(!_fenrys)return;ensureDir(TX_DIR);const _0x4f175f=_0x57e7df[_0x10f0ca(0xe8)](TX_DIR)[_0x10f0ca(0x7c)](_0x20fa67=>_0x20fa67[_0x10f0ca(0x86)](_0x10f0ca(0xbf)))['map'](_0x88913e=>_0x88913e[_0x10f0ca(0x8d)](_0x10f0ca(0xbf),''));for(const _0x4320b8 of _0x4f175f){let _0xa01eb4=readUserTx(_0x4320b8);if(!Array[_0x10f0ca(0xdb)](_0xa01eb4))_0xa01eb4=[_0xa01eb4][_0x10f0ca(0x7c)](Boolean);for(const _0x37c384 of _0xa01eb4){if(_0x37c384['status']!==_0x10f0ca(0xbe)&&_0x37c384['status']!==_0x10f0ca(0xae))continue;const _0x36595b=Date[_0x10f0ca(0x78)]();if(_0x36595b-(_0x37c384[_0x10f0ca(0x71)]||0x0)<_0x16cdcb)continue;_0x37c384['last_check_at']=_0x36595b,writeUserTx(_0x4320b8,_0xa01eb4);try{await handleTx(_fenrys,_0x4320b8,_0x37c384);}catch{}}}},_0x16cdcb);}