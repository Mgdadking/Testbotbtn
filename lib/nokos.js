const _0x1b0da5=_0x2afc;(function(_0x1554bf,_0x1a0a56){const _0x2724db=_0x2afc,_0x5ee543=_0x1554bf();while(!![]){try{const _0x477088=-parseInt(_0x2724db(0x11c))/0x1+parseInt(_0x2724db(0x130))/0x2*(parseInt(_0x2724db(0x111))/0x3)+parseInt(_0x2724db(0x156))/0x4*(parseInt(_0x2724db(0x125))/0x5)+parseInt(_0x2724db(0x118))/0x6+-parseInt(_0x2724db(0x109))/0x7+parseInt(_0x2724db(0x107))/0x8+-parseInt(_0x2724db(0x14d))/0x9;if(_0x477088===_0x1a0a56)break;else _0x5ee543['push'](_0x5ee543['shift']());}catch(_0x146563){_0x5ee543['push'](_0x5ee543['shift']());}}}(_0x4fe3,0xa7df4));import _0x454045 from'fs';import _0x3a9768 from'path';import _0x16a64e from'axios';import _0x39ee73 from'chalk';function _0x2afc(_0x408a4e,_0x1e5dea){_0x408a4e=_0x408a4e-0xff;const _0x4fe39a=_0x4fe3();let _0x2afc92=_0x4fe39a[_0x408a4e];return _0x2afc92;}import{createCanvas,loadImage}from'canvas';const TAG=_0x39ee73['yellow']('[NOKOS-POLLER]'),log=(..._0x7ebef0)=>console[_0x1b0da5(0x147)](TAG,..._0x7ebef0),ROOT=process[_0x1b0da5(0x10e)](),TX_DIR=_0x3a9768[_0x1b0da5(0x110)](ROOT,_0x1b0da5(0xff),_0x1b0da5(0x132)),DEP_DIR=_0x3a9768[_0x1b0da5(0x110)](ROOT,_0x1b0da5(0xff),'deposit'),USER_DB=_0x3a9768[_0x1b0da5(0x110)](ROOT,_0x1b0da5(0xff),_0x1b0da5(0x108)),TMP_DIR=_0x3a9768[_0x1b0da5(0x110)](ROOT,_0x1b0da5(0x159)),LOGO=_0x3a9768[_0x1b0da5(0x110)](ROOT,_0x1b0da5(0x138));function ensure(_0x27cc67){const _0x479086=_0x1b0da5;try{_0x454045[_0x479086(0x10f)](_0x27cc67,{'recursive':!![]});}catch{}}ensure(TX_DIR),ensure(DEP_DIR),ensure(TMP_DIR);function loadUsers(){const _0x5a66bf=_0x1b0da5;if(!_0x454045[_0x5a66bf(0x136)](USER_DB))_0x454045['writeFileSync'](USER_DB,JSON['stringify']({'users':{}},null,0x2));return JSON[_0x5a66bf(0x116)](_0x454045[_0x5a66bf(0x145)](USER_DB,_0x5a66bf(0x122)));}function saveUsers(_0x5b969e){const _0x3fe55b=_0x1b0da5;_0x454045[_0x3fe55b(0x143)](USER_DB,JSON[_0x3fe55b(0x13e)](_0x5b969e,null,0x2));}export async function makeQrisWatermark(_0x381429){const _0x5ea966=_0x1b0da5,_0x294856=await loadImage(_0x381429),_0x35fb15=await loadImage(LOGO),_0x2e8de4=Math[_0x5ea966(0x153)](_0x294856[_0x5ea966(0x149)],_0x294856[_0x5ea966(0x126)]),_0x594cc5=createCanvas(_0x2e8de4,_0x2e8de4),_0x89e253=_0x594cc5[_0x5ea966(0x13d)]('2d');_0x89e253['drawImage'](_0x294856,0x0,0x0,_0x2e8de4,_0x2e8de4);const _0x145bbd=_0x2e8de4*0.38,_0x4a42d9=_0x2e8de4*0.16,_0x30f6ba=(_0x2e8de4-_0x145bbd)/0x2,_0x1db3c7=(_0x2e8de4-_0x4a42d9)/0x2;_0x89e253[_0x5ea966(0x12a)]='#fff',_0x89e253[_0x5ea966(0x146)](_0x30f6ba,_0x1db3c7,_0x145bbd,_0x4a42d9),_0x89e253[_0x5ea966(0x120)](_0x35fb15,0x0,0x0,_0x2e8de4,_0x2e8de4);const _0x3fb6db=_0x3a9768[_0x5ea966(0x110)](TMP_DIR,'qris_'+Date[_0x5ea966(0x12d)]()+_0x5ea966(0x152));return _0x454045[_0x5ea966(0x143)](_0x3fb6db,_0x594cc5[_0x5ea966(0x139)](_0x5ea966(0x13a))),_0x3fb6db;}let running=![];export function startNokosPoller(_0x5022f2,_0x68626e=0x1388){const _0x22368a=_0x1b0da5;if(running)return;running=!![],log(_0x22368a(0x15b)),setInterval(async()=>{const _0x475b5f=_0x22368a;for(const _0x541e82 of _0x454045[_0x475b5f(0x12b)](TX_DIR)[_0x475b5f(0x14c)](_0x3aa854=>_0x3aa854[_0x475b5f(0x148)](_0x475b5f(0x115)))){const _0xded9e2=_0x3a9768[_0x475b5f(0x110)](TX_DIR,_0x541e82);let _0x1fde8e;try{_0x1fde8e=JSON['parse'](_0x454045[_0x475b5f(0x145)](_0xded9e2,'utf8'));}catch{continue;}if(_0x1fde8e[_0x475b5f(0x128)]!==_0x475b5f(0x106))continue;const _0x1c9cb3=Date[_0x475b5f(0x12d)]()-_0x1fde8e[_0x475b5f(0x117)];if(_0x1c9cb3>0x8*0x3c*0x3e8){try{await _0x16a64e[_0x475b5f(0x11d)](_0x475b5f(0x103)+_0x1fde8e['order_id']+'&status=cancel',{'headers':{'x-apikey':global[_0x475b5f(0x100)]}});}catch{}await _0x5022f2[_0x475b5f(0x10c)](_0x1fde8e[_0x475b5f(0x11f)],{'text':_0x475b5f(0x150)}),_0x454045['unlinkSync'](_0xded9e2);continue;}try{const _0x38ae38=await _0x16a64e['get'](_0x475b5f(0x135)+_0x1fde8e[_0x475b5f(0x157)],{'headers':{'x-apikey':global[_0x475b5f(0x100)]}});if(!_0x38ae38?.[_0x475b5f(0x13b)]?.[_0x475b5f(0x129)])continue;const _0x178e06=_0x38ae38['data'][_0x475b5f(0x13b)],_0x462eb7=String(_0x178e06[_0x475b5f(0x128)]||'')[_0x475b5f(0x10d)]();log('OTP\x20POLL',_0x1fde8e[_0x475b5f(0x157)],'status=',_0x462eb7);if(_0x462eb7===_0x475b5f(0x155)){const _0x2582c5=_0x178e06[_0x475b5f(0x12c)]||'-',_0x36ef0a=loadUsers();!_0x36ef0a[_0x475b5f(0x140)][_0x1fde8e[_0x475b5f(0x127)]]&&(_0x36ef0a[_0x475b5f(0x140)][_0x1fde8e[_0x475b5f(0x127)]]={'id':_0x1fde8e['sender'],'saldoNokos':0x0,'saldoTopup':0x0});if(typeof _0x36ef0a[_0x475b5f(0x140)][_0x1fde8e['uid']][_0x475b5f(0x14f)]!==_0x475b5f(0x14b))_0x36ef0a['users'][_0x1fde8e['uid']][_0x475b5f(0x14f)]=0x0;const _0x463d1b=Number(_0x36ef0a[_0x475b5f(0x140)][_0x1fde8e[_0x475b5f(0x127)]][_0x475b5f(0x14f)]||0x0),_0x27f084=Number(_0x1fde8e[_0x475b5f(0x119)]||0x0),_0x58f342=Math[_0x475b5f(0x133)](0x0,_0x463d1b-_0x27f084);log('SALDO\x20NOKOS\x20POTONG',_0x475b5f(0x131),_0x1fde8e['uid'],'before=',_0x463d1b,_0x475b5f(0x154),_0x27f084,_0x475b5f(0x14e),_0x58f342),_0x36ef0a[_0x475b5f(0x140)][_0x1fde8e[_0x475b5f(0x127)]][_0x475b5f(0x14f)]=_0x58f342,saveUsers(_0x36ef0a),await _0x5022f2[_0x475b5f(0x10c)](_0x1fde8e[_0x475b5f(0x11f)],{'text':_0x475b5f(0x13f)+(_0x475b5f(0x12f)+_0x1fde8e[_0x475b5f(0x157)]+'\x0a')+(_0x475b5f(0x121)+_0x178e06['phone_number']+'\x0a\x0a')+(_0x475b5f(0x137)+_0x2582c5+'\x0a\x0a')+'ðŸ’°\x20*Saldo\x20NOKOS:*\x0a'+(_0x475b5f(0x11a)+_0x463d1b+'\x0a')+(_0x475b5f(0x13c)+_0x27f084+'\x0a')+(_0x475b5f(0x12e)+_0x58f342)}),_0x454045['unlinkSync'](_0xded9e2);continue;}if(_0x462eb7===_0x475b5f(0x101)||_0x462eb7===_0x475b5f(0x15a)){await _0x5022f2['sendMessage'](_0x1fde8e['chat'],{'text':_0x475b5f(0x10a)}),_0x454045[_0x475b5f(0x142)](_0xded9e2);continue;}}catch(_0x487370){log(_0x475b5f(0x134),_0x487370[_0x475b5f(0x158)]);}}for(const _0x3fb94b of _0x454045['readdirSync'](DEP_DIR)[_0x475b5f(0x14c)](_0xb34546=>_0xb34546[_0x475b5f(0x148)](_0x475b5f(0x115)))){const _0x159191=_0x3a9768[_0x475b5f(0x110)](DEP_DIR,_0x3fb94b);let _0x420c60;try{_0x420c60=JSON[_0x475b5f(0x116)](_0x454045[_0x475b5f(0x145)](_0x159191,_0x475b5f(0x122)));}catch{continue;}if(Date[_0x475b5f(0x12d)]()>_0x420c60[_0x475b5f(0x124)]){_0x420c60[_0x475b5f(0x144)]&&await _0x5022f2[_0x475b5f(0x10c)](_0x420c60[_0x475b5f(0x11f)],{'delete':_0x420c60['msgKey']})['catch'](()=>{});await _0x5022f2[_0x475b5f(0x10c)](_0x420c60[_0x475b5f(0x123)],{'text':'â³\x20Deposit\x20expired\x20otomatis.'}),_0x454045[_0x475b5f(0x142)](_0x159191);continue;}try{const _0x4c3e3e=await _0x16a64e['get'](_0x475b5f(0x112)+_0x420c60[_0x475b5f(0x11e)],{'headers':{'x-apikey':global[_0x475b5f(0x100)]}}),_0x3d58c5=_0x4c3e3e?.[_0x475b5f(0x13b)]?.[_0x475b5f(0x13b)]?.[_0x475b5f(0x128)];log(_0x475b5f(0x15c),_0x420c60[_0x475b5f(0x11e)],_0x3d58c5);if(_0x3d58c5===_0x475b5f(0x129)){_0x420c60[_0x475b5f(0x144)]&&await _0x5022f2['sendMessage'](_0x420c60[_0x475b5f(0x11f)],{'delete':_0x420c60[_0x475b5f(0x144)]})[_0x475b5f(0x105)](()=>{});const _0x2be09e=loadUsers();if(!_0x2be09e['users'][_0x420c60[_0x475b5f(0x127)]])_0x2be09e[_0x475b5f(0x140)][_0x420c60[_0x475b5f(0x127)]]={'id':_0x420c60[_0x475b5f(0x123)],'saldo':0x0,'saldoNokos':0x0,'saldoTopup':0x0};_0x2be09e[_0x475b5f(0x140)][_0x420c60[_0x475b5f(0x127)]][_0x475b5f(0x14f)]+=_0x420c60[_0x475b5f(0x104)],saveUsers(_0x2be09e),await _0x5022f2[_0x475b5f(0x10c)](_0x420c60[_0x475b5f(0x123)],{'text':_0x475b5f(0x11b)+_0x420c60[_0x475b5f(0x104)]}),_0x454045[_0x475b5f(0x142)](_0x159191);continue;}if(_0x3d58c5===_0x475b5f(0x102)){_0x420c60['msgKey']&&await _0x5022f2[_0x475b5f(0x10c)](_0x420c60[_0x475b5f(0x11f)],{'delete':_0x420c60[_0x475b5f(0x144)]})['catch'](()=>{});await _0x5022f2[_0x475b5f(0x10c)](_0x420c60[_0x475b5f(0x123)],{'text':'âŒ\x20Deposit\x20dibatalkan.'}),_0x454045['unlinkSync'](_0x159191);continue;}}catch(_0x45f992){log(_0x475b5f(0x151),_0x45f992[_0x475b5f(0x158)]);}}},_0x68626e);}function _0x4fe3(){const _0x35c0c9=['writeFileSync','msgKey','readFileSync','fillRect','log','endsWith','width','ðŸ”„\x20nokos.js\x20updated','number','filter','19882035nJpQXx','after=','saldoNokos','â³\x20Order\x20expired\x20otomatis.\x0aSaldo\x20tidak\x20terpotong.','DEPO\x20API\x20ERR','.png','min','cut=','received','16wZvKel','order_id','message','tmp','expired','poller\x20started','DEPO','database','rumahOtpKey','canceled','cancel','https://www.rumahotp.com/api/v1/orders/set_status?order_id=','amount','catch','pending','9101080TqtGXm','user.json','3613645szIZbb','âŒ\x20Order\x20dibatalkan\x20/\x20expired.\x0aSaldo\x20tidak\x20terpotong.','watchFile','sendMessage','toLowerCase','cwd','mkdirSync','join','3OqMKin','https://www.rumahotp.com/api/v2/deposit/get_status?deposit_id=','?update=','pathname','.json','parse','created_at','4267428fGIxcU','price','Sebelum:\x20Rp\x20','âœ…\x20*Deposit\x20NOKOS\x20Berhasil*\x0aSaldo\x20NOKOS\x20+Rp\x20','412085vjsYOm','get','deposit_id','chat','drawImage','ðŸ“ž\x20Nomor:\x20','utf8','sender','expired_ts','845590VNuahI','height','uid','status','success','fillStyle','readdirSync','otp_code','now','Sisa:\x20Rp\x20','ðŸ“¦\x20Order\x20ID:\x20','2599388WhPcdG','uid=','transaction','max','OTP\x20API\x20ERR','https://www.rumahotp.com/api/v1/orders/get_status?order_id=','existsSync','ðŸ“©\x20OTP:\x0a','logo.png','toBuffer','image/png','data','Terpotong:\x20Rp\x20','getContext','stringify','âœ…\x20*OTP\x20MASUK*\x0a\x0a','users','redBright','unlinkSync'];_0x4fe3=function(){return _0x35c0c9;};return _0x4fe3();}const file=new URL(import.meta.url)[_0x1b0da5(0x114)];_0x454045[_0x1b0da5(0x10b)](file,()=>{const _0x240f37=_0x1b0da5;_0x454045['unwatchFile'](file),console[_0x240f37(0x147)](_0x39ee73[_0x240f37(0x141)](_0x240f37(0x14a))),import(import.meta.url+_0x240f37(0x113)+Date[_0x240f37(0x12d)]());});